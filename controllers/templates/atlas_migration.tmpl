env {
  name = atlas.env
  url = "{{ .URL }}"
  migration {
    {{- if .Cloud }}
      dir = data.remote_dir.this.url
    {{- end }}
    {{- with .Migration }}
      dir = "{{ .Dir }}"
    {{- end }}
  }
}

{{- with .Cloud }}
atlas {
  cloud {
  {{- if .URL }}
    url = "{{ .URL }}"
  {{- end }}
    token = "{{ .Token }}"
  {{- if .Project }}
    project = "{{ .Project }}"
  {{- end }}
  }
}
{{- end }}

{{- with .RemoteDir }}
data "remote_dir" "this" {
  {{- if .Name }}
    name = "{{ .Name }}"
  {{- end }}
  {{- if .Tag }}
    tag = "{{ .Tag }}"
  {{- end }}
}
{{- end }}
